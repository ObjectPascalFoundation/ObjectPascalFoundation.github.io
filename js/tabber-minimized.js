/* Copyright (c) 2006 Patrick Fitzgerald */
function tabberObj(e){var t;this.div=null;this.classMain="tabber";this.storeSelected=true;this.classMainLive="tabberlive";this.classTab="tabbertab";this.classTabDefault="tabbertabdefault";this.activeProperty="activetab";this.classNav="tabbernav";this.classTabHide="tabbertabhide";this.classNavActive="tabberactive";this.titleElements=["h2","h3","h4","h5","h6"];this.titleElementsStripHTML=true;this.removeTitle=true;this.addLinkId=false;this.linkIdFormat="<tabberid>nav<tabnumberone>";for(t in e){this[t]=e[t]}this.REclassMain=new RegExp("\\b"+this.classMain+"\\b","gi");this.REclassMainLive=new RegExp("\\b"+this.classMainLive+"\\b","gi");this.REclassTab=new RegExp("\\b"+this.classTab+"\\b","gi");this.REclassTabDefault=new RegExp("\\b"+this.classTabDefault+"\\b","gi");this.REclassTabHide=new RegExp("\\b"+this.classTabHide+"\\b","gi");this.tabs=new Array;if(this.div){this.init(this.div);this.div=null}}function tabberAutomatic(e){var t,n,r;if(!e){e={}}t=new tabberObj(e);n=document.getElementsByTagName("div");lAllTabs=[];for(r=0;r<n.length;r++){if(n[r].className&&n[r].className.match(t.REclassMain)){e.div=n[r];n[r].tabber=new tabberObj(e);n[r].tabber.allTabs=lAllTabs;lAllTabs.push(n[r].tabber)}}return this}function tabberAutomaticOnLoad(e){var t;if(!e){e={}}t=window.onload;if(typeof window.onload!="function"){window.onload=function(){tabberAutomatic(e)}}else{window.onload=function(){t();tabberAutomatic(e)}}}tabberObj.prototype.init=function(e){var t,n,r,i,s=0,o,u,a,f,l;if(!document.getElementsByTagName){return false}if(e.id){this.id=e.id}this.tabs.length=0;var c=this.storeSelected?$.cookie(this.activeProperty):undefined;t=e.childNodes;for(n=0;n<t.length;n++){if(t[n].className&&t[n].className.match(this.REclassTab)){i=new Object;i.div=t[n];this.tabs[this.tabs.length]=i;if(c&&i.div.title==c){s=this.tabs.length-1}else if(t[n].className.match(this.REclassTabDefault)){s=this.tabs.length-1}}}o=document.createElement("ul");o.className=this.classNav;for(n=0;n<this.tabs.length;n++){i=this.tabs[n];i.headingText=i.div.title;if(this.removeTitle){i.div.title=""}if(!i.headingText){for(r=0;r<this.titleElements.length;r++){l=i.div.getElementsByTagName(this.titleElements[r])[0];if(l){i.headingText=l.innerHTML;if(this.titleElementsStripHTML){i.headingText.replace(/<br>/gi," ");i.headingText=i.headingText.replace(/<[^>]+>/g,"")}break}}}if(!i.headingText){i.headingText=n+1}u=document.createElement("li");i.li=u;a=document.createElement("a");a.appendChild(document.createTextNode(i.headingText));a.href="javascript:void(null);";a.title=i.headingText;a.onclick=this.navClick;a.tabber=this;a.tabberIndex=n;if(this.addLinkId&&this.linkIdFormat){f=this.linkIdFormat;f=f.replace(/<tabberid>/gi,this.id);f=f.replace(/<tabnumberzero>/gi,n);f=f.replace(/<tabnumberone>/gi,n+1);f=f.replace(/<tabtitle>/gi,i.headingText.replace(/[^a-zA-Z0-9\-]/gi,""));a.id=f}u.appendChild(a);o.appendChild(u)}e.insertBefore(o,e.firstChild);e.className=e.className.replace(this.REclassMain,this.classMainLive);this.tabShow(s);if(typeof this.onLoad=="function"){this.onLoad({tabber:this})}return this};tabberObj.prototype.trySelect=function(e){for(var t=0;t<this.tabs.length;t++){if(this.tabs[t].headingText==e){this.tabShow(t);break}}};tabberObj.prototype.navClick=function(e){var t,n,r,i,s;n=this;if(!n.tabber){return false}r=n.tabber;i=n.tabberIndex;n.blur();if(r.storeSelected){$.cookie(r.activeProperty,r.tabs[i].headingText,{path:"/"});if(r.allTabs){for(var o=0;o<r.allTabs.length;o++){if(r.allTabs[o]!=r){r.allTabs[o].trySelect(r.tabs[i].headingText)}}}}if(typeof r.onClick=="function"){s={tabber:r,index:i,event:e};if(!e){s.event=window.event}t=r.onClick(s);if(t===false){return false}}r.tabShow(i);return false};tabberObj.prototype.tabHideAll=function(){var e;for(e=0;e<this.tabs.length;e++){this.tabHide(e)}};tabberObj.prototype.tabHide=function(e){var t;if(!this.tabs[e]){return false}t=this.tabs[e].div;if(!t.className.match(this.REclassTabHide)){t.className+=" "+this.classTabHide}this.navClearActive(e);return this};tabberObj.prototype.tabShow=function(e){var t;if(!this.tabs[e]){return false}this.tabHideAll();t=this.tabs[e].div;t.className=t.className.replace(this.REclassTabHide,"");this.navSetActive(e);if(typeof this.onTabDisplay=="function"){this.onTabDisplay({tabber:this,index:e})}return this};tabberObj.prototype.navSetActive=function(e){this.tabs[e].li.className=this.classNavActive;return this};tabberObj.prototype.navClearActive=function(e){this.tabs[e].li.className="";return this};if(typeof tabberOptions=="undefined"){tabberAutomaticOnLoad()}else{if(!tabberOptions["manualStartup"]){tabberAutomaticOnLoad(tabberOptions)}}